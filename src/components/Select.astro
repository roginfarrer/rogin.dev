---
import { faChevronDown } from "@fortawesome/free-solid-svg-icons";
import Box from "./Box.astro";
import Icon from "./Icon.astro";
import type { Sprinkles } from "./Box.css";
import { vars } from "src/vars.css";
import { css } from "styled-system/css";

type PandaCSS = Parameters<typeof css>[0];

const { label, id, "data-id": dataId, css: cssx, ...props } = Astro.props;

interface Props {
  label: string;
  id?: string;
  "data-id"?: string;
  css?: PandaCSS;
}
---

<label
  class={css(
    {
      textStyle: "sm",
      textAlign: "left",
      position: "relative",
      border: `2px solid token(colors.gray6)`,
      borderRadius: "lg",
      bg: "gray2",
      cursor: "auto",
      height: 44,
      minWidth: "150px",
      _focusWithin: {
        outline: `2px solid token(colors.accent9)`,
        outlineOffset: "1px",
      },
    },
    cssx,
  )}
  {...props}
>
  <span
    class={css({
      whiteSpace: "nowrap",
      fontSize: "0.8em",
      color: "gray11",
      position: "absolute",
      left: 2,
      top: 0,
    })}
  >
    {label}
  </span>
  <select
    data-id={dataId}
    class={css({
      textAlign: "left",
      appearance: "none",
      position: "absolute",
      bottom: 0,
      left: 0,
      pl: "2",
      pt: "22px",
      pb: 1,
      width: "100%",
      whiteSpace: "nowrap",
      _focusVisible: { outline: "none" },
    })}
    id={id}
  >
    <slot />
  </select>
  <Icon
    class={css({
      alignSelf: "center",
      position: "absolute",
      right: 2,
      top: "50%",
      translate: "0 -50%",
      pointerEvents: "none",
    })}
    aria-hidden="true"
    icon={faChevronDown}
    size="1em"
    style={{ strokeWidth: 3 }}
  />
</label>
